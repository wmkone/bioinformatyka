## Zad. 1
Poniżej znajduje się przyrównanie dwóch sekwencji DNA (`GATACTA` i `GATTTCAA`) w dwóch formach zapisu.

```
dna1   GA-TACTA-                       dna1   GA-TACTA-
       || |.| |                        dna2   GATTTC-AA
dna2   GATTTC-AA
```

Odpowiedz na pytania:

1. Ile wynosi długość powyższego przyrówania?
2. Na ilu pozycjach przyrównania:
   * nukleotydy są zgodne (*match*)
   * nukleotydy są niezgodne (*mismatch*)
   * występują przerwy (*gaps*)
3. Ile wynosi procent identyczności przyrównanych sekwencji?
4. Ile wynosi wartość punktacji (*score*) przyrównania sekwencji? Przyjmij poniższy system punktacji:
   * *match*: `2`
   * *mismatch*: `-1`
   * *gap*: `-2`


# Programowanie dynamiczne - algorytm

## Zad. 2
Wykonaj przyrównanie globalne (na [wydruku](../data/dynamic_programming-template.pdf)) dwóch sekwencji DNA przy pomocy **algorytmu Needlemana-Wunscha**. 

Przyjmij system punktacji: 

* match: `+3`
* mismatch: `-1`
* gap: `-2`

W odpowiedzi podaj uzyskane przyrównanie oraz wartość jego punktacji.


## Zad. 3
Wykonaj przyrównanie lokalne sekwencji z poprzedniego zadania (ten sam system punktacji) przy pomocy **algorytmu Smitha-Watermana**. W odpowiedzi podaj uzyskane przyrównanie oraz wartość jego punktacji.


## Zad. 4
Poniżej znajduje się przyrównanie dwóch sekwencji białkowych.

```
s1   MSSEATGEW                       s1   MSSEATGEW
     ||.:.:| |                       s2   MSKQISG-W
s2   MSKQISG-W
```

Odpowiedz na pytania:

1. Ile wynosi procent *identyczności* przyrównywanych sekwencji?
2. Punktacja dopasowania/niedopasowania każdego aminokwasu zależy od użytej macierzy substytucji. Najczęściej używa się macierzy BLOSUM62 (https://ftp.ncbi.nlm.nih.gov/blast/matrices/BLOSUM62). Ile wynosi wartość punktacji w tej macierzy dla:
   * dopasowania `M-M`
   * niedopasowania `E:Q`
   * niedopasowania `S.K`
   * niedopasowania `A.I`?
3. Ile wynosi procent *podobieństwa* przyrównywanych sekwencji?
4. Podaj wartość *score* całego przyrównania przy zastosowaniu macierzy BLOSUM62 i kary za przerwę: `-10`.



# Programy internetowe: needle i water


## Zad. 5
Poniżej znajduje się sekwencja genomowa genu insuliny oraz sekwencja kodująca (CDS, *Coding sequence*) tego genu. 

```
>J02989.1:DNA Owl monkey (A.trivirgatus) insulin gene, genomic
GGCCTAGCTAGGGCTGCTGTCCTGGGGTGGGCTGGGAATGGGCAGCCATCAGGCAGGGGCCCCCTCACTC
CCCTACCCCGACAACCTCGGCCCACCCATGGGGGCATCTCGGGCAACCAGAGATAGAGGGCAGGGGTCTG
GGGACAGCAGCGTGAAGAGCCCCGCCCTGCAGCCTCCCGCACTCCTGGTCTAATGTGGAAAGTGGCCCAG
ATGAGGGCTTTGCTCTCCTGGAGACATTTGCCCCCAGCTGTGAGCAGGGACAGGACTGGCCACCAGCGCC
TGGTTAAGACTCTAATGACCACCCCTCCCGGCCCTGAGGAAGAGGTGCTGACGACCAAGGAGATATTCCC
GCAGACCCAGCAGCCGGGAAATGATCTGGAAAGTGCAGCCTCAGCCCCCAGCCATCTGCCAGCCCCTGCA
CCTCAGGCCCTAATGGGCCAGGCGGCAAGGTTGGCAGGTAGGGGAGATGGGCTCTGGGCCTATAAAGCCA
GCAGGGACCCAGCAGCCCTCACGCCCGGGACCAGCTGCATCACAGGAGGCCAGCGAGCAGGTCTGTTCCA
AGGGCCTTCGAGCCAGTCTGGGCCCCAGGGCTGCCCCACTCGGGGTTCCAGAGCAGTTGGACCCCAGGTC
TCAGCGGGAGGGTGTGGCTGGGCTCTGAAGCATTTGGGTGAGCCCAGGGGCTCAGGGCAGGGCACCTGCC
TTCAGCGGCCTCAGCCTGCCTGTCTCCCAGGTCTCTGTCCTTCCACCATGGCCCTGTGGATGCACCTCCT
GCCCCTGCTGGCGCTGCTGGCCCTCTGGGGACCCGAGCCAGCCCCGGCCTTTGTGAACCAGCACCTGTGC
GGCCCCCACCTGGTGGAAGCCCTCTACCTGGTGTGCGGGGAGCGAGGTTTCTTCTACGCACCCAAGACCC
GCCGGGAGGCGGAGGACCTGCAGGGTGAGCCCCACCGCCCCTCCGTGCCCCCGCCGCCCCCAGCCACCCC
CACTCCCGCTGCTCCCACCCAGCCTGGGCAGAAGGGGACAGGAGGCTGCTACCAGTAGGGAGACAGGTGG
ACTTTTTAAAAAGAAATGAAGTTCTCTTGGTCACATCCTGAAAGTGACCAGCTCCCTGTGGCCCCGGCAG
AATCTCAGCCTGAGGACGGTATTGGCTTCGGCAGCTGAGCTCCGAGATACCTCGGAGGGCACGGCAGGGT
AGGGTCCTCCCTCCACGTGCCCCTCGAGCAAATGCCTCGCAGCCCACTTCTCCACCCTCACCTGAGGACC
GCAGCTTCCAGTGTTTTGTTGAGTACATCAAGTCCTGGGTGACCTGCGGTCACAGGGTGCCCCACGCTGC
CTGCCTGTGGCAAATGCCCCATGGCACCCTGAGGAAGGCATGGCTGCTGCCACGGTGGGCCAGACCCCTG
TCCCCGGGCTTCATGACAGCCTCCATAGTCAGGAAATGGGGCAGGCACTGGTGACAGGCCCTGGAAAGAC
GTACCGGGGGTACCCGTTCAGCCTCCTGCCATGGCACCACCCAGGGCATTGAAGTCCTGTATGTCCACAC
CCAGTGTGGGGCACCCTTCCTCAACCTGGGCCCAGCTCGGCTGAGGGGGTGAGGGCGTGACCTGGGGCTG
GCGGGCAGGCGGGCACCATCTCTCCCTGACTGTGCCATCCTGCGTGCCTCTTCCTCGCCGCTGTTCCGGA
CCTGCTCTGCGTGGCTCGCCCTGGCAGTGGGGCAGGTGGAGCTGGGTGGGGGCTCTATCACGGGCAGCCT
GCCACCCTTGGAGGGTCCCATGCAGAAGCGTGGCGTCGTGGATCAGTGCTGCACCAGCATCTGCTCCCTC
TACCAGCTGCAGAACTACTGCAACTAGACTGGGCCCACAGCGACCCCGTGCCCACTGCCACCTGCACCAG
CACCTGCTCCCTCTACCAGCTGGAGAACCACAGCTGGCTGCGGCCCACAGCAGGCCCAAATGCGGCCCTG
CACCCTCCTCACCTGCACATGAGTGATGGAATAAAGCCTTGAACCAGCTCTGCTGTGCTGTTTGCGTGTT
TGGGGGGCCCTGGGCAGACCCCGCCGTCCTGGCACTGTTATGAGCCCCTCCCAGCTCTCTCCAAGCTCTC
GCCCGGCCTGCAG

>J02989.1:CDS Owl monkey (A.trivirgatus) insulin gene, complete cds
ATGGCCCTGTGGATGCACCTCCTGCCCCTGCTGGCGCTGCTGGCCCTCTGGGGACCCGAGCCAGCCCCGG
CCTTTGTGAACCAGCACCTGTGCGGCCCCCACCTGGTGGAAGCCCTCTACCTGGTGTGCGGGGAGCGAGG
TTTCTTCTACGCACCCAAGACCCGCCGGGAGGCGGAGGACCTGCAGGTGGGGCAGGTGGAGCTGGGTGGG
GGCTCTATCACGGGCAGCCTGCCACCCTTGGAGGGTCCCATGCAGAAGCGTGGCGTCGTGGATCAGTGCT
GCACCAGCATCTGCTCCCTCTACCAGCTGCAGAACTACTGCAACTAG
```

Korzystając z internetowej wersji programów **needle** i **water** (<a href="https://www.ebi.ac.uk/jdispatcher/psa">https://www.ebi.ac.uk/jdispatcher/psa</a>) wykonaj - w dwóch kartach przeglądarki - przyrównanie powyższych sekwencji. Ustaw typ porównywanych sekwencji (*Input sequences*) jako DNA. Umieść pierwszą sekwencję w formacie FASTA w pierwszym polu tekstowym i drugą sekwencję w drugim polu. Wykonaj przyrównanie.

1. Z ilu egzonów składa się badany gen insuliny?
2. Podaj pozycję początku i końca egzonów w sekwencji genomowej.
3. Podaj procent identyczności dwóch przyrównań.
    - Dlaczego procent identyczności przyrównania w programie *needle* jest niższy niż w *water*? 

## Zad. 6
Poniżej znajdują się dwie sekwencje tego samego genu pochodzące od dwóch osób. Pierwsza sekwencja należy do pacjenta chorego na pewien zespół genetyczny, druga sekwencja pochodzi od człowieka niedotkniętego tą chorobą. Przyrównaj obie sekwencje i odpowiedz na pytanie, jakie zmiany w sekwencji tego genu występują u chorego pacjenta.

```
>sick
TTGCTGTGTGAGGCAGAACCTGCGGGGGCAGGGGCGGGCTGGTTCCCTGGCCAGCCATTGGCAGAGTCCG
CAGGCTAGGGCTGTCAATCATGCTGGCCGGCGTGGCCCCGCCTCCGCCGGCGCGGCCCCGCCTCCGCCGG
CGCAGCGTCTGGGACGCAAGGCGCCGTGGGGGCTGCCGGGACGGGTCCAAGATGGACGGCCGCTCAGGTT
CTGCTTTTACCTGCGGCCCAGAGCCCCATTCATTGCCCCGGTGCTGAGCGGCGCCGCGAGTCGGCCCGAG
GCCTCCGGGGACTGCCGTGCCGGGCGGGAGACCGCCATGGCGACCCTGGAAAAGCTGATGAAGGCCTTCG
AGTCCCTCAAGTCCTTCCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCA
GCAGCAGCAGCAGCAGCAGCAGCAGCAACAGCCGCCACCGCCGCCGCCGCCGCCGCCGCCTCCTCAGCTT
CCTCAGCCGCCGCCGCAGGCACAGCCGCTGCTGCCTCAGCCGCAGCCGCCCCCGCCGCCGCCCCCGCCGC
CACCCGGCCCGGCTGTGGCTGAGGAGCCGCTGCACCGACCAAAGAAAGAACTTTCAGCTACCAAGAAAGA
CCGTGTGAATCATTGTCTGACAATATGTGAAAACATAGTGGCACAGTCTGTCAGAAATTCTCCAGAATTT
CAGAAACTTCTGGGCATCGCTATGGAACTTTTTCTGCTGTGCAGTGATGACGCAGAGTCAGATGTCAGGA
TGGTGGCTGACGAATGCCTCAACAAAGTTATCAAAGCTTTGATGGATTCTAATCTTCCAAGGTTACAGCT
CGAGCTCTATAAGGAAATTAAAAAGAATGGTGCCCCTCGGAGTTTGCGTGCTGCCCTGTGGAGGTTTGCT
GAGCTGGCTCACCTGGTTCGGCCTCAGAAATGCAGGCCTTACCTGGTGAACCTTCTGCCGTGCCTGACTC
GAACAAGCAAGAGACCCGAAGAATCAGTCCAGGAGACCTTGGCTGCAGCTGTTCCCAAAATTATGGCTTC
TTTTGGCAATTTTGCAAATGACAATGAAATTAAGGTTTTGTTAAAGGCCTTCATAGCGAACCTGAAGTCA
AGCTCCCCCACCATTCGGCGGACAGCGGCTGGATCAGCAGTGAGCATCTGCCAGCACTCAAGAAGGACAC
AATATTTCTATAGTTGGCTACTAAATGTGCTCTTAGGCTTACTCGTTCCTGTCGAGGATGAACACTCCAC
TCTGCTGATTCTTGGCGTGCTGCTCACCCTGAGGTATTTGGTGCCCTTGCTGCAGCAGCAGGTCAAGGAC
ACAAGCCTGAAAGGCAGCTTCGGAGTGACAAGGAAAGAAATGGAAGTCTCTCCTTCTGCAGAGCAGCTTG
TCCAGGTTTATGAACTGACGTTACATCATACACAGCACCAAGACCACAATGTTGTGACCGGAGCCCTGGA
GCTGTTGCAGCAGCTCTTCAGAACGCCTCCACCCGAGCTTCTGCAAACCCTGACCGCAGTCGGGGGCATT
GGGCAGCTCACCGCTGCTAAGGAGGAGTCTGGTGGCCGAAGCCGTAGTGGGAGTATTGTGGAACTTATAG
CTGGAGGGGGTTCC

>healthy
TTGCTGTGTGAGGCAGAACCTGCGGGGGCAGGGGCGGGCTGGTTCCCTGGCCAGCCATTGGCAGAGTCCG
CAGGCTAGGGCTGTCAATCATGCTGGCCGGCGTGGCCCCGCCTCCGCCGGCGCGGCCCCGCCTCCGCCGG
CGCAGCGTCTGGGACGCAAGGCGCCGTGGGGGCTGCCGGGACGGGTCCAAGATGGACGGCCGCTCAGGTT
CTGCTTTTACCTGCGGCCCAGAGCCCCATTCATTGCCCCGGTGCTGAGCGGCGCCGCGAGTCGGCCCGAG
GCCTCCGGGGACTGCCGTGCCGGGCGGGAGACCGCCATGGCGACCCTGGAAAAGCTGATGAAGGCCTTCG
AGTCCCTCAAGTCCTTCCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCA
GCAGCAGCAGCAACAGCCGCCACCGCCGCCGCCGCCGCCGCCGCCTCCTCAGCTTCCTCAGCCGCCGCCG
CAGGCACAGCCGCTGCTGCCTCAGCCGCAGCCGCCCCCGCCGCCGCCCCCGCCGCCACCCGGCCCGGCTG
TGGCTGAGGAGCCGCTGCACCGACCAAAGAAAGAACTTTCAGCTACCAAGAAAGACCGTGTGAATCATTG
TCTGACAATATGTGAAAACATAGTGGCACAGTCTGTCAGAAATTCTCCAGAATTTCAGAAACTTCTGGGC
ATCGCTATGGAACTTTTTCTGCTGTGCAGTGATGACGCAGAGTCAGATGTCAGGATGGTGGCTGACGAAT
GCCTCAACAAAGTTATCAAAGCTTTGATGGATTCTAATCTTCCAAGGTTACAGCTCGAGCTCTATAAGGA
AATTAAAAAGAATGGTGCCCCTCGGAGTTTGCGTGCTGCCCTGTGGAGGTTTGCTGAGCTGGCTCACCTG
GTTCGGCCTCAGAAATGCAGGCCTTACCTGGTGAACCTTCTGCCGTGCCTGACTCGAACAAGCAAGAGAC
CCGAAGAATCAGTCCAGGAGACCTTGGCTGCAGCTGTTCCCAAAATTATGGCTTCTTTTGGCAATTTTGC
AAATGACAATGAAATTAAGGTTTTGTTAAAGGCCTTCATAGCGAACCTGAAGTCAAGCTCCCCCACCATT
CGGCGGACAGCGGCTGGATCAGCAGTGAGCATCTGCCAGCACTCAAGAAGGACACAATATTTCTATAGTT
GGCTACTAAATGTGCTCTTAGGCTTACTCGTTCCTGTCGAGGATGAACACTCCACTCTGCTGATTCTTGG
CGTGCTGCTCACCCTGAGGTATTTGGTGCCCTTGCTGCAGCAGCAGGTCAAGGACACAAGCCTGAAAGGC
AGCTTCGGAGTGACAAGGAAAGAAATGGAAGTCTCTCCTTCTGCAGAGCAGCTTGTCCAGGTTTATGAAC
TGACGTTACATCATACACAGCACCAAGACCACAATGTTGTGACCGGAGCCCTGGAGCTGTTGCAGCAGCT
CTTCAGAACGCCTCCACCCGAGCTTCTGCAAACCCTGACCGCAGTCGGGGGCATTGGGCAGCTCACCGCT
GCTAAGGAGGAGTCTGGTGGCCGAAGCCGTAGTGGGAGTATTGTGGAACTTCGAGCTGGAGGGGGTTCC
```

## Zad. 7
W bazie UniProt znajdź rekord acylfosfatazy u: człowieka (ID: `P14621`), *Escherichia coli* (ID: `P0AB65`) oraz *Shigella flexneri* (ID: `Q83LL9`). Wykorzystując program needle wykonaj przyrównanie dwóch par sekwencji:

Organizm 1 | Organizm 2
--- | ---
*E. coli* | *S. flexneri*
*E. coli* | *H. sapiens*

1. Które przyrównanie odznacza się wyższym poziomem identyczności sekwencji i ile wynosi?
2. Podaj wartość punktacji (`score`) obu przyrównań.
3. Wypisz wszystkie substytucje wraz z pozycją w przyrównaniu *E.coli - S. flexneri*.
4. Podaj procent identyczności i podobieństwa w przyrównaniu *E.coli - S. flexneri*.
5. Podaj kilkuaminokwasowy fragment sekwencji o pełnej zgodności w przyrównaniu *E. coli - H. sapiens*.
    * Jaka może być przyczyna zachowania tego fragmentu?
6. Jaka macierz substytucji aminokwasowych została użyta w tych przyrównaniach?


# Programy lokalne: needle i water


## Zad. 8
W dwóch plikach znajdują się dwie sekwencje proteazy serynowych: z *Bacillus lentus* ([data/protease_bacillus.fasta](../data/protease_bacillus.fasta)) i człowieka ([data/protease_human.fasta](../data/protease_human.fasta)). Pobierz oba pliki i wykonaj przyrównanie tych sekwencji używając lokalnie zainstalowanego programu `water`. Zapoznaj się z pomocą tego programu (`water -h`) i uruchom go, aby przekazać wszystkie argumenty w jednym poleceniu.

1. Ponownie przyrównaj te sekwencje programem *water*, tym razem zmniejszając karę za otwarcie przerwy = `1`.
    - W jaki sposób zmniejszenie kar za otwarcie przerw wpłynęło na to dopasowanie?
2. Ponownie przyrównaj sekwencje zwiększając kary za stosowanie przerw: otwarcie przerwy = `25`, wydłużenie przerwy = `5`.
    - W jaki sposób zwiększenie kar za stosowanie przerw wpłynęło na to dopasowanie?
3. Jak nazywa się model karania za przerwy przyjmujący dwa parametry: otwarcie i wydłużenie przerwy?
    > Wskazówka: https://en.wikipedia.org/wiki/Gap_penalty#Types.
4. Jak nazywa się model karania za przerwy, który używałe/aś w zadaniach 3-4?


## Zad. 9
Wykonaj przyrównanie sekwencji z poprzedniego zadania za pomocą programu `needle`. Następnie wykonaj kolejne przyrównanie tym razem dodając do polecenia opcję `-endweight`.

1. Na czym polega różnica między dwoma otrzymanymi przyrównaniami?
2. Które z przyrównań nazwał(a)byś semi-globalnym, a które globalnym?


## Zad. 10
Znajdź w bazie UniProt dwa białka o numerach dostępu: `GLBE_CHITH` i `GLB7A_CHITH`. Wykonaj semi-globalne przyrównanie tych sekwencji.

Podaj:

1. Wartość punktacji przyrównania
2. Procent identyczności
3. Procent podobieństwa
4. Najdłuższy fragment sekwencji, który uległ insercji/delecji. 